\chapter{Graded and filtered rings}

In algebraic geometry, working in classical affine space
$\mathbb{A}^n_{\mathbb{C}}$ of points in $\mathbb{C}^n$ turns out to be insufficient for various reasons.
Instead, it is often more convenient to consider varieties in \emph{projective
space} $\mathbb{P}^n_{\mathbb{C}}$, which is the set of lines through the
origin in $\mathbb{C}^{n+1}$. 
In other words, it is the set of all $n+1$-tuples $[z_0, \dots, z_n] \in
\mathbb{C}^{n+1} - \left\{0\right\}$ modulo the relation that
\[ [z_0, \dots, z_n] = [\lambda z_0, \dots, \lambda z_n], \quad \lambda \in
\mathbb{C}^*.  \]
Varieties in projective space  have many
convenient properties that affine varieties do not: for instance,
intersections work out much more nicely when intersections at the extra
``points at infinity'' are included. 

It is when defining the notion of a ``variety'' in projective space that one
encounters gradedness. Now a variety in $\mathbb{P}^n$ must be cut out by
polynomials $F_1, \dots, F_k \in \mathbb{C}[x_0, \dots, x_n]$; that is, a
point represented by $[z_0, \dots, z_n]$ lies in the associated variety if and
only if $F_i(z_0, \dots, z_n) = 0$ for each $i$. For this to make sense, or to
be independent of the choice of $z_0, \dots, z_n$, it is necessary to assume
that each $F_i$ is \emph{homogeneous.}

Algebraically, $\mathbb{A}^n_{\mathbb{C}}$ is the set of maximal ideals in the
polynomial ring $\mathbb{C}^{n}$. Projective space is defined somewhat more
geometrically (as a set of lines) but it turns out that there is an
algebraic interpretation here too. The points of projective space are in
bijection with the \emph{ homogeneous maximal ideals} of the polynomial ring
$\mathbb{C}[x_0, \dots, x_n]$. We shall define  more generally the $\proj$ of a
\emph{graded} ring in this chapter. Although we shall not repeatedly refer to
this concept in the sequel, it will be useful for readers interested in
algebraic geometry.

We shall also introduce the notion of a \emph{filtration}. A filtration allows
one to endow a given module with a topology, and one can in fact complete with
respect to this topology. This construction will be studied in
chapter~\ref{completions}.

\section{Graded rings and modules}

\subsection{Basic definitions}
\begin{definition} 
A \textbf{graded ring} $R$ is a ring together with a decomposition (as abelian groups)
\[  R = R_0 \oplus R_1 \oplus \dots   \]
such that $R_m R_n \subset R_{m+n}$ for all $m, n \in \mathbb{Z}_{\geq 0}$,
and where $R_0$ is a subring.
A \textbf{$\mathbb{Z}$-graded ring} is one where the decomposition is into
$\bigoplus_{n \in \mathbb{Z}} R_n$.
In either case, the elements of the subgroup $R_n$ are called
\textbf{homogeneous of degree $n$}.
\end{definition}

The basic example to keep in mind is, of course, the polynomial ring $R[x_1,
\dots, x_n]$ for $R$ any ring. The graded piece of degree $n$ consists of the
homogeneous polynomials of degree $n$.

\begin{definition} Fix a graded ring $R$.
A \textbf{graded} $R$-module is an ordinary $R$-module $M$ together with  a decomposition
\[  M = \bigoplus_{k \in \mathbb{Z}} M_k  \]
as abelian groups, such that $R_m M_n \subset M_{m+n}$ for all $m \in
\mathbb{Z}_{\geq 0}, n \in \mathbb{Z}$.
\end{definition} 

Since we shall focus on positively graded rings, we shall simply call them
graded rings; when we do have to consider rings with possibly negative
gradings, we shall highlight this explicitly. Note, however, that we allow
modules with negative gradings freely.
In fact, given a graded module $M$, we define the \textbf{twists} $M(n)$ as the
same $R$-module but with the grading
\[  M(n)_k = M_{n+k} . \]  

\begin{example} 
If $R$ is  a graded ring, then $R$ is a graded module over itself. 
\end{example} 

\begin{definition} Fix a graded ring $R$.
Let $M$ be a graded $R$-module and $N \subset M$ an $R$-submodule. Then $N$ is called  a
\textbf{graded submodule} if the homogeneous components of anything in $N$ are
in $N$. If $M=R$, then a graded ideal is also called a \textbf{homogeneous
ideal}.
\end{definition} 

In particular, a graded submodule is automatically a graded module in its own
right. 

\begin{lemma} 
\begin{enumerate}
\item  The sum of two graded submodules (in particular, homogeneous ideals) is graded.
\item  The intersection of two graded submodules is graded.
\end{enumerate}
\end{lemma} 
\begin{proof} 
Immediate.
\end{proof} 

One can grade the quotients of a graded module by a graded submodule.
If $N \subset M$ is a graded submodule, then $M/N$ can be made into a graded
module,  via the isomorphism of abelian groups
\[  M/N \simeq \bigoplus_{k \in \mathbb{Z}} M_k/N_k.  \]
In particular, if $\mathfrak{a} \subset R$ is a homogeneous ideal, then 
$R/\mathfrak{a}$ is a graded ring in a natural way.



Also, if $\mathfrak{a}, \mathfrak{b}$ are homogeneous ideals, then so is
$\mathfrak{ab}$.  Justification: if we have resolutions into homogeneous
components $\mathfrak{a} = \bigoplus \mathfrak{a}_i$, $\mathfrak{b} = \bigoplus
\mathfrak{b}_i$, then 
\[  \mathfrak{ab} = \sum_{i+j=k} \mathfrak{a}_i \mathfrak{b}_j . \]

\subsection{Homogeneous ideals}

Recall that a homogeneous ideal in a graded ring $R$ is simply a graded
submodule of $R$. We now prove a useful result that enables us tell when an
ideal is homogeneous.

\begin{proposition} 
Let $R$ be a graded ring, $I \subset R$ an ideal. Then $I$ is a graded ideal
if and only if it can be generated by homogeneous elements.
\end{proposition} 
\begin{proof} 
If $I$ is a homogeneous ideal, then by definition
\[ I = \bigoplus I \cap R_i,  \]
so $I$ is generated by the sets $\left\{I \cap R_i\right\}_{i \in
\mathbb{Z}_{\geq 0}}$ of homogeneous elements. 

Conversely, let us suppose that $I$ is generated by homogeneous elements
$\left\{h_\alpha\right\}$. Let $x \in I$ be arbitrary; we can uniquely
decompose $x$ as a sum of homogeneous elements, $x = \sum x_i$, where each
$x_i \in R_i$. We need to show that each $x_i \in I$ in fact.

To do this, note that $x = \sum q_\alpha h_\alpha$ where the $q_\alpha $
belong to $R$. If we take $i$th homogeneous components, we find that
\[ x_i = \sum ( q_{\alpha})_{i - \deg h_\alpha} h_\alpha, \]
where $(q_\alpha)_{i - \deg h_\alpha}$ refers to the component of $q_\alpha$
concentrated in the degree $i - \deg h_\alpha$.
From this it is easy to see that each $x_i$ is a linear combination of the
$h_\alpha$ and consequently lies in $I$.
\end{proof} 

Since we shall need to use them to define $\proj R$ in the future, we now
prove a result about homogeneous prime ideals specifically. Namely, primeness
can be checked just on homogeneous elements for a homogeneous ideal.
\begin{lemma} \label{homogeneousprimeideal}
Let $\mathfrak{p} \subset R$ be a homogeneous ideal. In order that $\mathfrak{p}$ be prime, it is
necessary and sufficient that whenever $x,y$ are \emph{homogeneous} elements
such that $xy \in \mathfrak{p}$, then at least one of $x,y \in \mathfrak{p}$.
\end{lemma} 
\begin{proof} 
Necessity is immediate. For sufficiency, suppose $a,b  \in R$ and $ab \in
\mathfrak{p}$. We must prove that one of these is in $\mathfrak{p}$. Write 
\[  a = a_0 + a_1  + \dots + a_k,  \ b = b_0 + \dots + b_m  \]
as a decomposition into homogeneous components, where $a_k, b_m$ are nonzero.

We will prove that one of $a,b \in \mathfrak{p}$ by induction on $m+n$. When this is
zero, then it is just the condition of the lemma.
Suppose it true for smaller values of $m+n$.
Then $ab$ has highest homogeneous component $a_k b_m$, which must be in $\mathfrak{p}$
by homogeneity.  Thus one of $a_k, b_m$ belongs to $\mathfrak{p}$. Say for
definiteness it is $a_k$. Then we have that
\[  (a-a_k)b \equiv ab \equiv 0 \  \mathrm{mod} \  \mathfrak{p}  \]
so that $(a-a_k)b \in \mathfrak{p}$. But the resolutions of $a-a_k, b$ have a smaller
$m+n$-value. By the inductive hypothesis, it follows that one of these is in
$\mathfrak{p}$, and since $a_k \in \mathfrak{p}$, we find that one of $a,b \in \mathfrak{p}$.  
\end{proof} 

\subsection{Finiteness conditions}
There are various finiteness conditions that one often wants to impose in
algebraic geometry.
Since projective varieties (and schemes) are obtained from graded rings,
we briefly discuss these finiteness conditions for them.

For a graded ring $R$, write $R_+ = R_1 \oplus R_2 \oplus \dots$. Clearly $R_+
\subset R$ is a homogeneous ideal. It is called the \textbf{irrelevant ideal.}

\begin{proposition} 
Suppose $R = R_0 \oplus R_1 \oplus \dots$ is  a graded ring. Then if a subset
of $R_+$ generates $R_+$ as $R$-ideal, it generates $R$ as $R_0$-algebra.
\end{proposition} 
The converse is clear as well. 
Indeed, if $S \subset R_+$ generates $R$ as an $R_0$-algebra, clearly it
generates $R_+$ as an $R$-ideal. 
\begin{proof} 
Let $T \subset R$ be the $R_0$-algebra generated by $S$. We shall show
inductively that $R_n \subset T$. This is true for $n=0$. Suppose $n>0$ and the
assertion true for smaller $n$. Then, we have
\begin{align*}
R_n  & = RS \cap R_n   \ \text{by assumption} \\
& = (R_0 \oplus R_1 \oplus \dots R_{n-1})(S) \cap R_n \ \text{because $S$ bumps
the deg} \\
& \subset (R_0[S]) (S) \cap R_n \ \text{by inductive hypothesis} \\
& \subset R_0(S). \end{align*}
\end{proof} 
\begin{theorem} 
$R$ is noetherian if and only if $R_0$ is noetherian and $R$ is finitely
generated as $R_0$-algebra.
\end{theorem} 
\begin{proof} 
One direction is clear by Hilbert's basis theorem. For the other, suppose $R$
noetherian. Then $R_0$ is noetherian because any sequence $I_1 \subset I_2
\subset \dots$ of ideals of $R_0$ leads to a sequence of ideals $I_1 R \subset
I_2 R \subset \dots$, and since these stabilize, the original $I_1 \subset I_2
\subset \dots$ must stabilize too.  Since $R_+$ is a finitely generated
$R$-ideal, it follows that $R$ is a finitely generated $R_0$-algebra too.
\end{proof} 

The basic condition we will often need is that $R$ is finitely generated as an
$R_0$-algebra. We may also want to have that $R$ is generated by $R_1$, quite
frequently---this will imply a bunch of useful things about certain sheaves
being invertible. 
However, sometimes we have the first condition and not the second. Then the
next idea comes in handy.

\begin{definition} 
Let $R$ be a graded ring and $d \in \mathbb{N}$. We set $R^{(d)} = \bigoplus_{k
\in \mathbb{Z}_{\geq 0}} R_{kd}$.  If $M$ is a graded $R$-module and $l \in
\left\{0, 1, \dots, d-1\right\}$, we write $M^{(d,l)} = \bigoplus_{k \equiv l
\mathrm{mod} d} M_k$. Then $M^{(d,l)}$ is an $R^{(d)}$-module. 
\end{definition} 

One of the implications of the next few results is that, by replacing $R$ with
$R^{(d)}$, we can make the condition ``generated by terms of degree 1'' happen.
But first, we show that basic finiteness is preserved if we filter out some of
the terms.

\begin{proposition} \label{duple preserves finiteness}
Let $R$ be a graded ring and a finitely generated $R_0$-algebra. Let $M$ be a
finitely generated $R$-module.
\begin{enumerate}
\item Each $M_i$ is finitely generated over $R_0$, and the $M_i$ become zero when $i \ll
0$.
\item  $M^{(d,l)}$ is a finitely generated $R^{(d)}$ module for each $d,l$. In
particular, $M$ itself is a finitely generated $R^{(d)}$-module.
\item $R^{(d)}$ is a finitely generated $R_0$-algebra.
\end{enumerate}
\end{proposition} 
\begin{proof} 
Choose homogeneous generators $m_1, \dots, m_k \in M$. Then every nonzero
element of $M$ has degree at least $\min(\deg m_i)$.  This proves the
last part of (1). Moreover, let $r_1, \dots, r_p$ be generators of $R$ over
$R_0$.
We can assume that these are homogeneous with positive degrees $d_1, \dots, d_p>0$.
Then the space $M_i$ is spanned as an $R_0$-module by the elements
\[  r_1^{a_1} \dots r_p^{a_p} m_s  \]
where $\sum a_j d_j + \deg m_s = i$.  Since the $d_j>0$ and there are only
finitely many $m_s$'s, there are only finitely many such elements. This proves
the rest of (1).

To prove (2), note first that it is sufficient to show that $M$ is finitely
generated over $R^{(d)}$, because the $M^{(d,l)}$ are $R^{(d)}$-homomorphic
images.
Now $M$ is generated as $R_0$-module by the $r_1^{a_1} \dots r_p^{a_p} m_s $
for $a_1, \dots, a_p \geq 0$ and $s = 1, \dots,  k$.
In particular, by the euclidean algorithm in elementary number theory, it
follows that the 
$r_1^{a_1} \dots r_p^{a_p} m_s $
for $a_1, \dots, a_p \in [0, d-1]$ and $s = 1, \dots,  k$ generate $M$ over
$R^{(d)}$, as each power $r_i^{d} \in R^{(d)}$.

When we apply (2) to the finitely generated $R$-module $R_+$, it follows that $R^{(d)}_+$ is a finitely generated
$R^{(d)}$-module. This implies that $R^{(d)}$ is a finitely generated
$R_0$-algebra by \cref{}.
\end{proof}

In particular, $R$ is integral over $R^{(d)}$. This can easily be seen
directly. The $d$th power of a homogeneous element lies in $R^{(d)}$.  
\begin{remark} 
Part (3), the preservation of the basic finiteness condition, could also be
proved as follows, at least in the noetherian case (with $S = R^{(d)}$). 
\begin{lemma} 
Suppose $R_0 \subset S \subset R$ is an inclusion of rings with $S$ noetherian. Suppose $R$ is a
finitely generated $R_0$-algebra and $R/S$ is an integral extension. Then $S$
is a finitely generated $R_0$-algebra.
\end{lemma} 
\begin{proof} 
Indeed, let $r_1, \dots, r_m$ be generators of $R/S$. Each satisfies an
integral equation $r_k^{n_k} + P_k(r_k) = 0$, where $P_k \in S[X]$ has degree
less than $n_k$. Let $S' \subset S$ be the subring generated over $R_0$ by the
coefficients of all these polynomials $P_i$.  
Then $R$ is, by definition, integral over $S'$; so is $S$, as a result. But
$S'$ is a finitely generated $R_0$-algebra and $S$ is a finitely generated
$S'$-module (because $R$ is a finitely generated $S'$-module and $S'$ is
noetherian, while $S \subset R$). Therefore, $S$ is a finitely generated $R_0$-algebra.
\end{proof} 
This result implies, incidentally, that if a finite group acts on a polynomial
ring $R[X_1, \dots, X_n]$, the ring of invariants is finitely generated.
\end{remark} 

We next show that we can have $R^{(d)}$ generated by terms of degree $d$ (i.e.
``degree 1'' if we rescale) for $d$ chosen large.
\begin{lemma} 
Hypotheses as above, there is a pair $(d, n_0)$ such that
\[  R_d M_n = M_{n+d}  \]
for $n \geq n_0$.
\end{lemma} 
\begin{proof} 
Indeed, select generators $m_1, \dots, m_k \in M$ and $r_1, \dots, r_p \in R$
as in the above proof; use the same notation for their degrees.
Let $d $ be the least common multiple of the $d_j$.  Consider the family of
elements
\[  s_i = r_i^{d/d_i} \in R_d. \]
Then suppose $m \in M_n$ for $n>ld + \sup \deg m_i$.  We have that $m$ is a sum
of products of powers of $r_i$ and the $m_i$, each term of which we can assume is
of degree $n$.  In this case, since at least one
of the $r_i$ must occur to power $\geq \frac{d}{d_i}$, we can write each term
in the sum as $s_i$ times something in $M_{n-d}$. 

In particular,
\[ M_n  = S_d M_{n-d}.  \]
\end{proof} 

\begin{proposition} 
Suppose $R$ is a graded ring and finitely generated $R_0$-algebra. Then there
is $d \in \mathbb{N}$ such that $R^{(d)}$ is generated over $R_0$ by $R_d$.
\end{proposition} 
\begin{proof} 
Suppose $d'$ is as in the previous lemma (replacing $d$, which we reserve for
something else), and choose $n_0$ accordingly. Let $d$ be a multiple of $d'$
which is greater than $n_0$.

Then we have $R_d R_n = R_{d+n}$ if $n \geq d$ since $d$ is a multiple of $d'$.
In particular, it follows that $R_{nd} = (R_d)^n$ for each $n \in \mathbb{N}$,
which implies the statement of the proposition.
\end{proof} 

As we will see below, taking $R^{(d)}$ does not affect the $\proj$, so this is
useful.

We next show that taking the $R^{(d)}$ \emph{always} preserves noetherianness.

\begin{proposition} \label{filtnoetherian}
If $R$ is noetherian, then so is $R^{(d)}$ for any $d>0$.
\end{proposition} 
\begin{proof} 
If $R$ is noetherian, then $R_0$ is noetherian and $R$ a finitely generated
$R_0$-algebra. The previous result, \cref{duple preserves
finiteness},  now implies that $R^{(d)} $ is also a
finitely generated $R_0$-algebra, so it is noetherian.
\end{proof} 

The converse is also true, since $R$ is a finitely generated $R^{(d)}$-module.

\subsection{Localization of graded rings}
Next, we include a few topics that we shall invoke later on. 
First, we discuss the interaction of homogeneity and localization.

If $S \subset R$ is a multiplicative subset of a graded (or
$\mathbb{Z}$-graded) ring $R$ consisting of homogeneous elements, then $S^{-1}
R$ is a $\mathbb{Z}$-graded ring.  We write $R_{(S)}$ for the subring of
elements of degree zero; there is thus a map $R_0 \to R_{(S)}$.
If $S$ consists of the powers of a homogeneous element $f$, we write $R_{(f)}$
for $R_S$. If $\mathfrak{p}$ is a homogeneous ideal and $S$ the set of
homogeneous elements of $R$ not in $\mathfrak{p}$, we write
$R_{(\mathfrak{p})}$ for $R_{(S)}$.

We shall show that $R_{(f)}$ is a special case of something familiar.

\begin{proposition} \label{loc interpret as quotient ring}
Suppose $f$ is of degree $d$. Then $R_{(f)} \simeq R^{(d)}/(f-1)$.
\end{proposition} 
\begin{proof} 
The homomorphism $R^{(d)} \to R_{(f)}$ is defined to map $g \in R_{kd}$ to $g/f^d \in
R_{(f)}$.  This is then extended by additivity to non-homogeneous elements. It
is clear that this is multiplicative, and that the ideal $(f-1)$ is annihilated
by the homomorphism.
Moreover, this is surjective.

We shall now define an inverse map. Let $x/f^n \in R_{(f)}$; then $x$ must be
a homogeneous element of degree divisible by $d$. We map this to
the residue class of $x$ in $R^{(d)}/(f-1)$.  This is well-defined; if $x/f^n =
y/f^m$, then there is $N$ with
\[ f^N( xf^m - yf^n) = 0,  \]
so upon reduction (note that $f$ gets reduced to $1$!), we find that the
residue classes of $x,y$ are the same, so the images are the same.

Clearly this defines an inverse to our map.
\end{proof} 

\begin{corollary} 
Suppose $R$ is a graded noetherian ring. Then each of the $R_{(f)}$ is
noetherian.
\end{corollary} 
\begin{proof} 
This follows from the previous result and the fact that $R^{(d)}$ is noetherian
(\cref{filtnoetherian}).\end{proof} 

More generally, we can define the localization procedure for graded modules.
\begin{definition} 
Let $M$ be a graded $R$-module and $S \subset R$ a multiplicative subset
consisting of homogeneous elements. Then we define $M_{(S)}$ as the submodule
of the graded module $S^{-1}M$ consisting of elements of degree zero. When $S$
consists of the powers of a homogeneous element $f \in R$, we write $M_{(f)}$
instead of $M_{(S)}$. We similarly define $M_{(\mathfrak{p})}$ for a
homogeneous prime ideal $\mathfrak{p}$.
\end{definition} 

Then clearly $M_{(S)}$ is a $R_{(S)}$-module. This is evidently a functor from
graded $R$-modules to $R_{(S)}$-modules.

We next observe that there is a generalization of \cref{loc interpret as quotient ring}.
\begin{proposition} \label{loc
module as quotient}
Suppose $M$ is a graded $R$-module, $f \in R$ homogeneous of degree $d$. Then
there is  an isomorphism
\[ M_{(f)} \simeq M^{(d)}/(f-1)M^{(d)}  \]
of $R^{(d)}$-modules.
\end{proposition}
\begin{proof} 
This is proved in the same way as \cref{loc interpret as quotient
ring}. Alternatively, both are right-exact functors that commute with
arbitrary direct sums and coincide on $R$, so must be naturally isomorphic by
a well-known bit of abstract nonsense.\footnote{Citation needed.} 
\end{proof} 

In particular:
\begin{corollary} 
Suppose $M$ is a graded $R$-module, $f \in R$ homogeneous of degree 1. Then we
have
\[  M_{(f)} \simeq M/(f-1)M \simeq M\otimes_R R/(f-1).  \]
\end{corollary} 

\subsection{The $\proj$ of a ring}
Let $R=R_0 \oplus R_1 \oplus \dots$ be a \textbf{graded ring}.

\begin{definition} 
Let $\proj R$ denote the set of \emph{homogeneous prime ideals} of
$R$ that do not contain the \textbf{irrelevant ideal} $R_+$.\footnote{Recall that an ideal $\mathfrak{a} \subset R$ for $R$ graded is
\emph{homogeneous} if the homogeneous components of $\mathfrak{a}$ belong to
$\mathfrak{a}$.}

\end{definition} 

We can put a topology on $\proj R$ by setting, for a homogeneous ideal
$\mathfrak{b}$, $$V(\mathfrak{b}) = \{ \mathfrak{p} \in \proj R:
\mathfrak{p} \supset \mathfrak{b}\}$$.  These sets satisfy
\begin{enumerate}
\item $V( \sum \mathfrak{b_i}) = \bigcap V(\mathfrak{b_i})$.
\item  $V( \mathfrak{a}\mathfrak{b}) = V(\mathfrak{a}) \cup V(\mathfrak{b})$.
\item  $V( \rad \mathfrak{a}) = V(\mathfrak{a})$.
\end{enumerate}
Note incidentally that we would not get any more closed sets if we allowed all
ideals $\mathfrak{b}$, since to any $\mathfrak{b}$ we can consider its ``homogenization.''
We could even allow all sets.

In particular,  the $V$'s do in fact yield a topology on $\proj R$ (setting
the open sets to be complements of the $V$'s).
As with the affine case, we can define basic open sets. For $f$
homogeneous of positive degree, define $D'(f)$ to be the
collection of homogeneous ideals (not containing $R_+$) that do not contain $f$; clearly these are
open sets.

Let $\mathfrak{a}$ be a homogeneous ideal. Then I claim that:
\begin{lemma} 
\[  V(\mathfrak{a}) = V(\mathfrak{a} \cap R_+).  \]
\end{lemma} 
\begin{proof} 
Indeed, suppose $\mathfrak{p}$ is a homogeneous prime not containing $S_+$ such that all homogeneous
elements of positive degree in $\mathfrak{a}$ (i.e., anything in $\mathfrak{a}
\cap R_+$) belongs to $\mathfrak{p}$. We will
show that $\mathfrak{a} \subset \mathfrak{p}$.

Choose $a \in \mathfrak{a} \cap R_0$. It is sufficient to show that any such
$a$ belongs to $\mathfrak{p}$ since we are working with homogeneous ideals.
Let $f$ be a homogeneous element of positive degree that is not in
$\mathfrak{p}$.  Then $af \in \mathfrak{a} \cap R_+$, so $af \in \mathfrak{p}$.
But $f \notin \mathfrak{p}$, so $a \in \mathfrak{p}$.
\end{proof} 

Thus, when constructing these closed sets $V(\mathfrak{a})$, it suffices to
work with ideals contained in the irrelevant ideal. In fact, we could take
$\mathfrak{a}$ in any prescribed power of the irrelevant ideal, since taking
radicals does not affect $V$.

\begin{proposition} 
We have $D'(f) \cap D'(g) = D'(fg)$. Also, the $D'(f)$ form a basis for the
topology on $\proj R$.
\end{proposition} 
\begin{proof} The first part is evident, by the definition of a prime ideal. We prove the second.
Note that $V(\mathfrak{a})$ is the intersection of the $V((f))$ for the
homogeneous $f \in
\mathfrak{a} \cap R_+$. Thus $\proj R - V(\mathfrak{a})$ is the union of these $D'(f)$. 
So every open set is a union of sets of the form $D'(f)$.
\end{proof} 

We shall now 
show that the topology is actually rather familiar from the affine case, which
is not surprising, since the definition is similar.

\begin{proposition} 
$D'(f)$ is homeomorphic to $\spec R_{(f)}$ under the map
\[  \mathfrak{p}  \to \mathfrak{p} R_f \cap R_{(f)}  \]
sending homogeneous prime ideals of $R$ not containing $f$ into primes of
$R_{(f)}$.
\end{proposition} 
\begin{proof} 
Indeed, let $\mathfrak{p}$ be a homogeneous prime ideal of $R$ not containing
$f$. Consider $\phi(\mathfrak{p}) = \mathfrak{p} R_f \cap R_{(f)} $ as above.
This is a prime ideal, since $\mathfrak{p}  R_f$ is a prime ideal in $R_f$ by
basic properties of localization, and $R_{(f)} \subset R_f$ is a subring. (It
cannot contain the identity, because that would imply that a power of $f$ lay
in $\mathfrak{p}$.)

So we have defined a map $\phi: D'(f) \to \spec R_{(f)}$.  We can define its
inverse $\psi$ as follows. Given $\mathfrak{q} \subset R_{(f)} $ prime, we define a
prime ideal $\mathfrak{p} = \psi(\mathfrak{q})$ of $R$ by saying that a \textit{homogeneous} element $x \in
R$ belongs to $\mathfrak{p}$ if and only if $x^{\deg f}/f^{\deg x} \in
\mathfrak{q}$. It is easy to see that this is indeed an ideal, and that it is
prime by \cref{homogeneousprimeideal}.

Furthermore, it is clear that $\phi \circ \psi $ and $\psi \circ \phi$ are the identity.
This is because $x \in \mathfrak{p}$ for $\mathfrak{p} \in D'(f)$ if and only
if $f^n x \in \mathfrak{p}$ for some $n$.

We next need to check that these are continuous, hence homeomorphisms.  If
$\mathfrak{a} \subset R$ is a homogeneous ideal, then $V(\mathfrak{a}) \cap
D'(f)$ is
mapped to $V(\mathfrak{a}R_f \cap R_{(f)}) \subset \spec R_{(f)}$, and vice
versa.
\end{proof} 

\section{Filtered rings}

\subsection{The associated graded}

\section{The Artin-Rees lemma}
