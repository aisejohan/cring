\chapter{Homological Algebra}


Homological algebra begins with the notion of a \emph{differential object,}
that is, an object with an endomorphism $A \stackrel{d}{\to} A$ such that $d^2 =
0$. This equation leads to the obvious inclusion $\im(d) \subset \ker(d)$, but
the inclusion generally is not equality. We will find that the difference
between $\ker(d)$ and $\im(d)$, called the \emph{homology}, is a highly useful
variant of a differential object: its first basic property is that if an exact
sequence
\[ 0 \to A' \to A \to A'' \to 0  \]
of differential objects is given, the homology of $A$ is related to that of
$A', A''$ through a long exact sequence. The basic example, and the one we
shall focus on, is where $A$ is a
chain complex, and $d$ the usual differential.
In this case, homology simply measures the failure of a complex to be exact.

After introducing these preliminaries, we develop the theory of \emph{derived
functors}. Given a functor that is only left or right-exact, derived functors
allow for an extension of a partially exact sequence to a long exact sequence.
The most important examples to us, $\mathrm{Tor}$ and $\mathrm{Ext}$, provide
characterizations of flatness, projectivity, and injectivity.

We will then apply the general theory to commutative algebra proper. The use
of homological machinery provides a new characterization of regular local
rings and leads to proofs of several difficult results about them.

\section{Complexes}


\subsection{Chain complexes}
The chain complex is the most fundamental construction in
homological algebra.

\begin{definition} A chain complex is a collection of modules
over a ring $C_i$
for integer values of $i$. Usually we will find that $C_i=0$ for
negative values of $i$. Equipped with the $C_i$ are boundary
operators
$\partial_i:C_i\rightarrow C_{i-1}$ with the property that
$\partial_{i-1}\partial_i=0$. Sometimes the boundary map is also
called the
``differential.'' Often, notation is abused and the indices for
the boundary map are dropped.\end{definition}


\begin{example} All exact sequences are chain complexes.
\end{example}

\begin{example} Any sequence of abelian groups for which the
boundary operators
are all $0$ is a chain complex. \end{example}

We will see plenty of more examples in due time.

\begin{definition} The submodule of cycles $Z_i\subseteq C_i$ is
the kernel $\ker(\partial_i)$. The submodule of boundaries
$B_i\subseteq C_i$ is the image $Im(\partial_{i+1})$. Thus
homology is said to be ``cycles mod boundaries,'' i.e.
$Z_i/B_i$.
\end{definition}

To further simplify notation, often all differentials regardless
of what chain complex they are part of are denoted $\partial$,
thus the commutativity relation on chain maps is
$f\partial=\partial f$ with indices and distinction between the
boundary operators dropped.


\begin{definition} Let $C_*$ be a chain complex with boundary
map $\partial_*$.
We define the \textbf{homology} of the complex $C_*$ via
$H_i(C_*)=\ker(\partial_i)/Im(\partial_{i+1})$.
\end{definition}

\begin{example} In a chain complex $C_*$ where all the boundary
maps are
trivial, $H_i(C_*)=C_i$. 
\end{example}

Often we will bundle all the modules $C_i$ of a chain complex
together to form a graded module $C_*=\bigoplus_i C_i$. In this
case, the boundary operator is a
endomorphism that takes elements from degree $i$ to degree
$i-1$. Similarly, we
often bundle together all the homology modules to give a graded
homology module
$H_*(C_*)=\bigoplus_i H_i(C_*)$.

\subsection{Functoriality}
It turns out that chain complexes form a category when morphisms
are appropriately defined.
\begin{definition} A map of chain complexes $f:C_*\rightarrow
D_*$, or a chain map, is a sequence of maps $f_i:C_i\rightarrow
D_i$ such that $f\partial = \partial' f$ where $\partial$ is the
boundary map of $C_*$ and $\partial'$ of $D_*$ (again we are
abusing notation and dropping indices). \end{definition}
\begin{theorem} Chain maps induce maps in homology in the same
direction; in other words, homology is a covariant functor from
the category of chain complexes to the category of graded
modules.\end{theorem}
\begin{proof}
Let $f:C_*\rightarrow D_*$ be a chain map. Let $\partial$ and
$\partial'$ be the differentials for $C_*$ and $D_*$
respectively. Then we have a commutative diagram:

\begin{equation}
\begin{CD}
C_{i+1} @>\partial_{i+1}>> C_i @>>\partial_i> C_{i-1}\\
@VV f_{i+1} V          @VV f_i V             @VVf_{i-1} V\\
D_{i+1} @>\partial'_{i+1}>> D_i @>>\partial'_i> D_{i-1}
\end{CD}
\end{equation}

Now, in order to check that a chain map $f$ induces a map $f_*$
on homology, we need to check that $f_*(Im(\partial))\subseteq
Im(\partial')$ and $f_*(\ker(\partial))\subseteq
\ker(\partial)$. We first check the condition on images: we want
to look at $f_i(Im(\partial_{i+1}))$. By commutativity of $f$
and the boundary maps, this is equal to
$\partial'_{i+1}(Im(f_{i+1})$. Hence we have
$f_i(Im(\partial_{i+1}))\subseteq Im(\partial_{i+1}')$. For the
condition on kernels, let $x\in \ker(\partial_i)$. Then by
commutativity, $\partial'_i(f_i(x))=f_{i-1}\partial_i(x)=0$.
Thus we have that $f$ induces for each $i$ a homomorphism
$f_i:H_i(C_*)\rightarrow H_i(D_*)$ and hence it induces a
homomorphism on homology as a graded module. \end{proof}

\subsection{Long exact sequences}
\add{OMG! We have all this and not the most basic theorem of them all.}

\begin{definition} If $M$ is a complex then for any integer $k$, we define a new complex $M[k]$ by shifting indices, i.e. $(M[k])^i:=M^{i+k}$.\end{definition}

\begin{definition} If $f:M\rightarrow N$ is a map of complexes, we define a complex $\mathrm{Cone}(f):=\{N^i\oplus M^{i+1}\}$ with differential
$$d(n^i,m^{i+1}):= (d_N^i(n_i)+(-1)^i\cdot f(m^{i+1}, d_M^{i+1}(m^{i+1}))$$
\end{definition}

Remark:  This is a special case of the total complex construction to be seen later.

\begin{proposition} A map $f:M\rightarrow N$ is a quasi-isomorphism if and only if $\mathrm{Cone}(f)$ is acyclic.\end{proposition}

\begin{proposition}  Note that by definition we have a short exact sequence of complexes
$$0\rightarrow N\rightarrow \mathrm{Cone}(f)\rightarrow M[1]\rightarrow 0$$
so by Proposition 2.1, we have a long exact sequence
$$\dots \rightarrow H^{i-1}(\mathrm{Cone}(f))\rightarrow H^{i}(M)\rightarrow H^{i}(N)\rightarrow H^{i}(\mathrm{Cone}(f))\rightarrow\dots$$
so by exactness, we see that $H^i(M)\simeq H^i(N)$ if and only if $H^{i-1}(\mathrm{Cone}(f))=0$ and $H^i(\mathrm{Cone}(f))=0$.  Since this is the case for all $i$, the claim follows. $\blacksquare$
\end{proposition}



\subsection{Cochain complexes}
Cochain complexes are much like chain complexes except the
arrows point in the
opposite direction.
\begin{definition} A cochain complex is a series of modules
$C^i$ for integer
values of $i$ (again, it is common that $C^i=0$ for negative
values of $i$). The
cochain complex is also equipped with coboundary operators, also
called
differentials, $\partial^i:C^i\rightarrow C^{i+1}$ such that
$\partial^{i+1}\partial^i=0$. Given a cochain complex $C^*$, we
define the
cohomology objects to be
$h^i(C^*)=\ker(\partial^i)/Im(\partial^{i-1})$.
\end{definition}
Similarly, we can also turn cochain complexes and cohomology
modules into a
graded module.


\begin{example}[The de Rham complex] Readers unfamiliar with differential
forms may omit this example. Let $M$ be a smooth manifold. For each $p$, let
$C^p(M)$ be the $\mathbb{R}$-vector space of smooth $p$-forms on $M$.
We can make the $\left\{C^p(M)\right\}$ into a complex by defining the maps
\[ C^p(M) \to C^{p+1}(M)  \]
via $\omega \to d \omega$, for $d$ the exterior derivative. 
(Note that $d^2 = 0$.)  This complex is called the \textbf{de Rham complex} of
$M$, and its cohomology is called the \textbf{de Rham cohomology.} It is known
that the de Rham cohomology is isomorphic to singular cohomology with real
coefficients. 
\end{example} 

\subsection{Long exact sequence}

\subsection{Chain Homotopies}


\begin{definition} A chain homotopy between two chain maps
$f,g:C_*\rightarrow D_*$ is a series of homomorphisms
$t^i:C^i\rightarrow D^{i-1}$ satisfying $f^i-g^i=\partial t^n+
t^{n+1}\partial$. Again often notation is abused and the
condition is written $f-g=\partial t +
t\partial$.
\end{definition}

\begin{theorem} If two maps are chain homotopic, they are taken
to the same induced map after applying the homology functor.
\end{theorem}

\begin{corollary} If two chain complexes are chain homotopically equivalent
(there are maps $f: C_*\rightarrow D_*$ and $g:D_*\rightarrow
C_*$ such that both $fg$ and $gf$ are chain homotopic to the
identity), they have isomorphic homology.
\end{corollary}
\begin{proof} 
Clear.
\end{proof} 

\begin{example}  Not every quasi-isomorphism is a homotopy equivalence.  Consider the complex
$$\dots \rightarrow 0\rightarrow\mathbb{Z}/{\cdot 2}\rightarrow \mathbb{Z}\rightarrow 0\rightarrow 0\rightarrow\dots$$
so $H^0=\mathbb{Z}/2\mathbb{Z}$ and all cohomologies are 0.  We have a quasi-isomorphism from the above complex to the complex
$$\dots \rightarrow 0\rightarrow 0 \rightarrow \mathbb{Z}/2\mathbb{Z}\rightarrow 0\rightarrow 0\rightarrow\dots$$
but no inverse can be defined (no map from $\mathbb{Z}/2\mathbb{Z}\rightarrow \mathbb{Z}$).
\end{example}


\begin{proposition} Additive functors preserve chain homotopies
\end{proposition}
\begin{proof} Since an additive functor $F$ is a homomorphism on $Hom(-,-)$,
the chain homotopy condition will be preserved; in
particular, if $t$ is a chain homotopy, then $F(t)$ is a chain
homotopy.
\end{proof}

In more sophisticated homological theory, one often makes the
definition of the ``homotopy category of chain complexes.''
\begin{definition} The homotopy category of chain complexes is
the category $hKom(R)$ where objects are chain complexes of
$R$-modules and morphisms are chain maps modulo chain homotopy.
\end{definition}


\subsection{Topological remarks}
The first homology theory
to be developed was simplicial homology - the study of homology
of simplicial
complexes. To be simple, we will not develop the general theory
and instead
motivate our definitions with a few basic examples.

\begin{example} Suppose
our simplicial complex has one line segment with both ends
identified at
one point $p$. Call the line segment $a$. The $n$-th homology
group of this
space roughly counts how many ``different ways'' there are of
finding $n$
dimensional sub-simplices that have no boundary that aren't the
boundary of
any $n+1$ dimensional simplex. For the circle, notice that for
each integer,
we can find such a way (namely the simplex that wraps counter
clockwise that
integer number of times). The way we compute this is we look at
the free abelian group generated by $0$ simplices, and $1$
simplices (there are no simplices of
dimension $2$ or higher so we can ignore that). We call these
groups $C_0$ and
$C_1$ respectively. There is a boundary map $\partial_1:
C_1\rightarrow C_0$.
This boundary map takes a $1$-simplex and associates to it its
end vertex minus
its starting vertex (considered as an element in the free
abelian group on
vertices of our simplex). In the case of the circle, since there
is only one
$1$-simplex and one $0$-simplex, this map is trivial. We then
get our homology
group by looking at $\ker(\partial_1)$. In the case that there
is a nontrivial
boundary map $\partial_2: C_2\rightarrow C_1$ (which can only
happen when our
simplex is at least $2$-dimensional), we have to take the
quotient
$\ker(\partial_1)/\ker(\partial_2)$. This motivates us to define
homology in a
general setting.
\end{example}

Originally homology was
intended to be a homotopy invariant meaning that space with the
same homotopy type would have isomorphic homology modules. In fact, any
homotopy induces what is now known as a chain homotopy on the simplicial chain
complexes.

\begin{exercise}[Singular homology] Let $X$ be a topological
space and let $S^n$ be the set of all continuous maps
$\Delta^n\rightarrow X$ where $\Delta^n$ is the convex hull of
$n$ distinct points and the origin with orientation given by an
ordering of the $n$ vertices. Define $C_n$ to be the free
abelian group generated by elements of $S^n$. Define
$\Delta^n_{\hat{i}}$ to be the face of $\Delta^n$ obtained by
omitting the $i$-th vertex from the simplex. We can then
construct a boundary map $\partial_n:C_n\rightarrow C_{n-1}$ to
take a map $\sigma^n:\Delta^n\rightarrow X$ to
$\sum_{i=0}^n(-1)^i\sigma^n|_{\Delta^n_{\hat{i}}}$. Verify that
$\partial^2=0$ (hence making $C_*$ into a chain complex known as
the ``singular chain complex of $X$''. Its homology groups are
the ``singular homology groups''. \end{exercise}

\begin{exercise} Compute the singular homology groups of a
point. \end{exercise}


\subsection{Projective resolutions}

Fix a ring $R$.
Let us recall (\rref{projectives}) that an $R$-module $P$ is called
\emph{projective} if the functor $N \to \hom_R(P,N)$ (which is always
left-exact) is exact.

Projective objects are useful in defining chain exact sequences
known as ``projective resolutions.''

\begin{definition} Let $M$ be an arbitrary module, a projective
resolution of
$M$ is an exact sequence
\begin{equation} \cdots\rightarrow P_i\rightarrow
P_{i-1}\rightarrow
P_{i-2}\cdots\rightarrow P_1\rightarrow P_0\rightarrow M
\end{equation} where
the $P_i$ are projective modules. \end{definition}


\begin{proposition} Any module admits a projective resolution. \end{proposition}
\begin{proof} 
We construct the resolution inductively. 
First, we take a projective module $P_0$ with $P_0 \twoheadrightarrow N$
surjective by the previous part.  Given a portion of the resolution
\[ P_n \to P_{n-1} \to \dots \to P_0 \twoheadrightarrow N \to 0  \]
for $n \geq 0$, which is exact at each step, we consider $K = \ker(P_n \to
P_{n-1})$. The sequence 
\[ 0 \to K \to P_n \to P_{n-1} \to \dots \to P_0 \twoheadrightarrow N \to 0  \]
is exact. So if $P_{n+1}$ is chosen such that it is projective and there is an
epimorphism
\( P_{n+1} \twoheadrightarrow K,  \)
(which we can construct by \rref{freesurjection}), then
\[ P_{n+1} \to P_n \to \dots  \]
is exact at every new step by construction. We can repeat this inductively and
get a full projective resolution.
\end{proof}

Here is a useful observation:
\begin{proposition}
If $R$ is noetherian, and $M$ is finitely generated, then we can
choose a
projective resolution where each $P_i$ is finitely generated.
\end{proposition}
\begin{proof}
To say that $M$ is finitely generated is to say that it is a
quotient of a free module on
finitely many generators, so we can take $P_0$ free. The kernel
of $P_0 \to M$
is finitely generated by noetherianness, and we can proceed as
before, at each step
choosing a finitely generated object.
\end{proof}
\begin{example} The abelian group $\mathbb{Z}/2$ has the free
resolution $0\rightarrow\cdots
0\rightarrow\mathbb{Z}\rightarrow\mathbb{Z}\rightarrow\mathbb{Z}/2$.
Similarly, since any finitely generated abelian group can be
decomposed into the direct sum of torsion subgroups and free
subgroups, all finitely generated abelian groups admit a
resolution of the type shown above.\end{example}

In general, projective resolutions are not at all unique. 
Nonetheless, they \emph{are} unique up to chain homotopy. Thus a projective
resolution is a rather good ``replacement'' for the initial module.

\begin{proposition} 
Let $M, N$ be modules and let $P_* \to M, P'_* \to N$ be projective
resolutions. Let $f: M \to N$ be a morphism. Then there is a morphism
\[ P_* \to P'_*  \]
such that the following diagram commutes:
\[ 
\xymatrix{
\dots \ar[r] &  P_1 \ar[r] \ar[d]  &  P_0 \ar[r] \ar[d]  &  M \ar[d]^f  \\
\dots \ar[r] &  P'_1 \ar[r] &  P'_0 \ar[r] &  N
}
\]
This morphism is unique up to chain homotopy.
\end{proposition} 
\begin{proof} 
Let $P_* \to M$ and $P'_* \to N$ be projective resolutions. We will define a
morphism of complexes $P_* \to P'_* $ such that the diagram commutes. 
Let the boundary maps in $P_*, P'_*$ be denoted $d$  (by abuse of notation). 
We have an exact diagram
\[ 
\xymatrix{
\dots \ar[r] &  P_n \ar[r]^d &  P_{n-1} \ar[r]^d &  \dots \ar[r]^d & P_0
\ar[r]&  M \ar[d]^{f} \ar[r] &  0 \\
\dots \ar[r] &  P'_n \ar[r]^d &  P'_{n-1} \ar[r] &  \dots \ar[r]^d & P'_0 \ar[r] &  N \ar[r] &  0 
}
\]
Since $P'_0 \twoheadrightarrow N$ is an epimorphism, the map $P_0 \to M \to N$ lifts
to a map $P_0 \to P'_0$ making the diagram
\[ \xymatrix{
P_0 \ar[d] \ar[r] &  M \ar[d]^{f} \\ 
P'_0 \ar[r] &  N
}\]
commute. 
Suppose we have defined maps $P_i \to P'_i$ for $i \leq n$ such that the
following diagram commutes:
\[ 
\xymatrix{
P_n \ar[r]^d \ar[d]  &  P_{n-1} \ar[r]^d \ar[d] &  \dots \ar[r]^d & P_0
\ar[d]  \ar[r]&  M \ar[d]^{f} \ar[r] &  0 \\
P'_n \ar[r]^d &  P'_{n-1} \ar[r] &  \dots \ar[r]^d & P'_0 \ar[r] &  N \ar[r] &  0 
}
\]
Then we will define $P_{n+1} \to P'_{n+1}$, after which induction will prove
the existence of a map. To do this, note that 
the map
\[ P_{n+1} \to P_n \to P'_n \to P'_{n-1}  \]
is zero, because this is the same as $P_{n+1} \to P_n \to P_{n-1} \to P'_{n-1}$
(by induction, the diagrams before $n$ commute), and this is zero because two
$P$-differentials were composed one after another. In particular, in the diagram
\[ 
\xymatrix{
P_{n+1}   \ar[r] &  P_n \ar[d]  \\
P'_{n+1} \ar[r] & P'_n
},
\]
the image in $P'_n$ of $P_{n+1}$ lies in the kernel of $P'_n \to P'_{n-1}$,
i.e. in the image $I$ of $P'_{n+1}$.  The exact diagram
\[ 
\xymatrix{
& P_{n+1} \ar[d]  \\
P'_{n+1} \ar[r] & I \ar[r] &  0
}
\]
shows that we can lift $P_{n+1} \to I$ to $P_{n+1} \to P'_{n+1}$ (by
projectivity). This implies that we can continue the diagram further and get a
morphism $P_* \to P'_* $ of complexes. 	



Suppose $f, g: P_* \to P'_*$ are two morphisms of the projective resolutions
making $$\xymatrix{
P_0 \ar[r] \ar[d] &  M \ar[d] \\ 
P'_0 \ar[r] &  N
}$$ commute. We will show that $f,g$ are chain homotopic. 

For this,
we start by defining $D_0: P_0 \to P'_1$ such that $dD_0 = f-g: P_0 \to P'_0$.
This we can do because $f-g$ sends $P_0$ into $\ker(P'_0 \to N)$, i.e. into the
image of $P'_1 \to P'_0$, and $P_0$ is projective.
Suppose we have defined chain-homotopies $D_i: P_{i} \to P_{i+1}$ for $i \leq
n$ such that $dD_i + D_{i-1}d = f-g$ for $i \leq n$. We will define $D_{n+1}$.
There is a diagram
\[ 
\xymatrix{
 & P_{n+1} \ar[d]  \ar[r] &  P_n \ar[ld]^{D_n}\ar[d] \ar[r] & P_{n-1}
 \ar[ld]^{D_{n-1}} \ar[d]  \\
P'_{n+2} \ar[r] & P'_{n+1}   \ar[r] &  P'_n  \ar[r] & P'_{n-1}  \\
}\]
where the squares commute regardless of whether you take the vertical maps to
be $f$ or $g$ (provided that the choice is consistent). 	

We would like to define $D_{n+1}: P_n \to P'_{n+1}$. 
The key condition we need satisfied is that
\[ d D_{n+1} = f - g - D_n d.  \]
However, we know that, by the inductive hypothesis on the $D$'s
\[ d( f- g - D_{n}d) = fd  - gd - dD_n d = fd - gd - (f-g)d + D_n dd = 0.  \]
In particular, $f-g - D_n d$ lies in the image of $P'_{n+1} \to P'_n$.
The projectivity of $P_n$ ensures that we can define $D_{n+1}$ satisfying the
necessary condition. 

\end{proof} 


\begin{corollary} 
Let $P_* \to M, P'_* \to M$ be projective resolutions of $M$. Then there are
maps $P_* \to P'_*, P'_* \to P_* $ under $M$ such that the compositions are
chain homotopic to the identity.
\end{corollary} 
\begin{proof} 
Immediate.
\end{proof} 

\subsection{Injective resolutions}

One can dualize all this to injective resolutions. \add{do this}

\section{Derived functors}
Often in homological algebra, we see that ``short exact
sequences induce long exact sequences.'' Using the theory of
derived functors, we can make this formal.

Let us work in the category of modules over a ring $R$. Fix two such categories.
Recall that a right-exact functor $F$ (from the category of modules over a
ring to the category of modules over another ring) is an additive functor
 such that for every short
exact sequence $0\rightarrow A\rightarrow B\rightarrow
C\rightarrow 0$, we get a exact sequence $F(A)\rightarrow
F(B)\rightarrow F(C)\rightarrow 0$.

We want a natural way to continue this exact sequence to the
left; one way of doing this is to define the left derived
functors.
\begin{definition} Let $F$ be a right-exact functor and
$P_*\rightarrow M$ are projective resolution. We can form a
chain complex $F(P_*)$ whose object in degree $i$ is $F(P_i)$
with boundary maps $F(\partial)$. The homology of this chain
complex denoted $L_iF$ are the left derived functors.
\end{definition}

For this definition to be useful, it is important to verify that
deriving a functor yields functors independent on choice of
resolution. This is clear by \rref{}.

\begin{theorem} The following properties characterize derived
functors: \begin{enumerate}
\item{ $L_0F(-)=F(-)$ }
\item{ Suppose $0\rightarrow A\rightarrow B\rightarrow
C\rightarrow 0$ is an exact sequence and $F$ a right-exact
functor; the left derived functors fit into the following exact
sequence:

\begin{equation} \cdots L_iF(A)\rightarrow L_iF(B)\rightarrow
L_iF(C)\rightarrow L_{i-1}F(A)\cdots\rightarrow
L_1(C)\rightarrow L_0F(A)\rightarrow L_0F(B)\rightarrow
L_0F(C)\rightarrow 0 \end{equation}}
\end{enumerate}
\end{theorem}
\begin{proof} The second property is the hardest to prove, but
it is by far the most useful; it is essentially an application
of the snake lemma. \end{proof}
One can define right derived functors analogously; if one has a
left exact functor (an additive functor that takes an exact
sequence $0\rightarrow A\rightarrow B\rightarrow C\rightarrow 0$ to
$0\rightarrow F(A)\rightarrow F(B)\rightarrow F(C)$), we can
pick an injective resolution instead (the injective criterion is simply the
projective criterion with arrows reversed). If
$M\rightarrow I^*$ is a injective resolution then the cohomology of the chain
complex $F(I^*)$ gives the right derived functors.
However, variance must also be taken into consideration so the
choice of whether or not to use a projective or injective
resolution is of importance (in all of the above, functors were
assumed to be covariant). In the following, we see an example of when right
derived functors can be computed using projective
resolutions.

\newcommand{\ext}{\operatorname{Ext}}
\subsection{$\ext$ functors}

\begin{definition} The right derived functors of $Hom(-,N)$ are
called the $Ext$-modules denoted $Ext^i_R(-,N)$.
\end{definition}
We now look at the specific construction:

Let $M, M'$ be $R$-modules. Choose a projective resolution
\[ \dots \to P_2 \to P_1 \to P_0 \to M \to 0  \]
and consider what happens when you hom this resolution into $N$.
Namely, we can
consider $\hom_R(M,N)$, which is the kernel of $\hom(P_0, M)
\to\hom(P_1, M) $
by exactness of the sequence
\[ 0 \to \hom_R(M,N) \to \hom_R(P_0, N) \to \hom_R(P_1, N) . \]
You might try to continue this with the sequence
\[ 0 \to \hom_R(M,N) \to \hom_R(P_0, N) \to \hom_R(P_1, N) \to
\hom_R(P_2, N)
\to \dots. \]
In general, it won't be exact, because $\hom_R$ is only
left-exact. But it is a
chain complex. You can thus consider the homologies.

\begin{definition}
The homology of the complex $\{\hom_R(P_i, N)\}$ is denoted
$\ext^i_R(M,N)$. By
definition, this is $\ker(\hom(P_i,N) \to \hom(P_{i+1},
N))/\im(\hom(P_{i-1},
N) \to \hom(P_i,N))$. This is an $R$-module, and is called the
$i$th ext group.
\end{definition}



Let us list some properties (some of these properties are just
case-specific examples of general properties of derived
functors)

\begin{proposition}
$\ext_R^0(M,N) = \hom_R(M,N)$.
\end{proposition}
\begin{proof}
This is obvious from the left-exactness of $\hom(-,N)$. (We
discussed this.)
\end{proof}

\begin{proposition}
$\ext^i(M,N)$ is a functor of $N$.
\end{proposition}
\begin{proof}
Obvious from the definition.
\end{proof}

Here is a harder statement.
\begin{proposition}
$\ext^i(M,N)$ is well-defined, independent of the projective
resolution $P_*
\to M$, and is in fact a contravariant additive functor of
$M$.\footnote{I.e. a map $M
\to M'$ induces $\ext^i(M', N) \to \ext^i(M,N)$.}
\end{proposition}
\begin{proof}
Omitted. We won't really need this, though; it requires more
theory about
chain complexes.
\end{proof}


\begin{proposition}
If $M$ is annihilated by some ideal $I \subset R$, then so is
$\ext^i(M,N)$ for
each $i$.
\end{proposition}
\begin{proof}
This is a consequence of the functoriality in $M$. If $x \in
I$,then $x: M \to
M$ is the zero map, so it induces the zero map on
$\ext^i(M,N)$.\end{proof}

\begin{proposition}
$\ext^i(M,N) = 0$ if $M$ projective and $i>0$.
\end{proposition}
\begin{proof}
In that case, one can use the projective resolution
\[ 0 \to M \to M \to 0.  \]
Computing $\ext$ via this gives the result.
\end{proof}




\begin{proposition}
If there is an exact sequence
\[ 0 \to N' \to N \to N'' \to 0,  \]
there is a long exact sequence of $\ext$ groups
\[ 0 \to \hom(M,N') \to \hom(M,N) \to \hom(M,N'') \to
\ext^1(M,N') \to
\ext^1(M,N) \to \dots  \]
\end{proposition}
\begin{proof}
This proof will assume a little homological algebra. Choose a
projective
resolution $P_* \to M$. (The notation $P_*$ means the chain
complex $\dots \to
P_2 \to P_1 \to P_0$.) In general, homming out of $M$ is not
exact, but homming
out of a projective module is exact. For each $i$, we get an
exact sequence
\[ 0 \to \hom_R(P_i, N') \to \hom_R(P_i, N) \to \hom_R(P_i,
N'')\to 0, \]
which leads to an exact sequence of \emph{chain complexes}
\[ 0 \to \hom_R(P_*,N') \to \hom_R(P_*,N) \to \hom_R(P_*,N'')
\to 0 . \]
Taking the long exact sequence in homology gives the result.
\end{proof}


Much less obvious is:

\begin{proposition}
There is a long exact sequence in the $M$ variable. That is, a
short exact
sequence
\[ 0 \to M' \to M \to M'' \to 0  \]
leads a long exact sequence
\[ 0 \to \hom_R(M'', N) \to \hom_R(M,N) \to \hom_R(M', N) \to
\ext^1(M'', N)
\to \ext^1(M, N) \to \dots.  \]
\end{proposition}
\begin{proof}
Omitted.
\end{proof}

We now can characterize projectivity:
\begin{corollary}
TFAE:
\begin{enumerate}
\item $M$ is projective.
\item $\ext^i(M,N) = 0$ for all $R$-modules $N$ and $i>0$.
\item  $\ext^1(M,N)=0$ for all $N$.
\end{enumerate}
\end{corollary}
\begin{proof}
We have seen that 1 implies 2 because projective modules have
simple projective
resolutions. 2 obviously implies 3. Let's show that 3 implies
1.Choose a
projective module $P$ and a surjection $P \twoheadrightarrow M$
with kernel
$K$. There is a short exact sequence $0 \to K \to P \to M \to
0$. The sequence
\[ 0 \to \hom(M,K) \to \hom(P,K) \to \hom(K,K) \to
\ext^1(M,K)=0\]
shows that there is a map $P \to K$ which restricts to the
identity $K \to K$.
The sequence $0 \to K \to P \to M \to 0$ thus splits, so $M$ is
a direct
summand in a projective module, so is projective.
\end{proof}


Finally, we note that there is another way of constructing
$\ext$. We
constructed them by choosing a projective resolution of $M$. But
you can also
do this by resolving $N$ by \emph{injective} modules.
\begin{definition}
An $R$-module $Q$ is \textbf{injective} if $\hom_R(-,Q)$ is an
exact (or,
equivalently, right-exact) functor. That is, if $M_0 \subset M$
is an inclusion
of $R$-modules, then any map $M_0 \to Q$ can be extended to $M
\to Q$.
\end{definition}

If we are given $M,N$, and an injective resolution $N \to Q_*$,
we can look at
the chain complex $\left\{\hom(M,Q_i)\right\}$, i.e. the chain
complex
\[ 0 \to \hom(M, Q^0) \to \hom(M, Q^1) \to \dots  \]
and we can consider the cohomologies.

\begin{definition}
We call these cohomologies
\[ \ext^i_R(M,N)' = \ker(\hom(M, Q^i) \to \hom(M,
Q^{i+1}))/\im(\hom(M,
Q^{i-1}) \to \hom(M, Q^i)).  \]
\end{definition}

This is dual to the previous definitions, and it is easy to
check that the
properties that we couldn't verify for the previous $\ext$s are
true for the
$\ext'$'s.

Nonetheless:

\begin{theorem}
There are canonical isomorphisms:
\[ \ext^i(M,N)' \simeq \ext^i(M,N).  \]
\end{theorem}

In particular, to compute $\ext$ groups, you are free either to
take a
projective resolution of $M$, or an injective resolution of
$N$.\begin{proof}[Idea of proof]
In general, it might be a good idea to construct a third more
complex
construction that resembles both. Given $M,N$ construct a
projective resolution
$P_* \to M$ and an injective resolution $N \to Q^*$. Having made
these choices,
we get a \emph{double complex}
\[ \hom_R(P_i, Q^j)  \]
of a whole lot of $R$-modules. The claim is that in such a
situation, where
you have a double complex $C_{ij}$, you can
form an ordinary chain complex $C'$
by adding along the diagonals. Namely, the $n$th term
is $C'_n = \bigoplus_{i+j=n} C_{ij}$. This \emph{total complex}
will receive a
map from the chain complex used to compute the $\ext$ groups
and a chain
complex used to compute the $\ext'$ groups. There are maps on
cohomology,
\[ \ext^i(M,N) \to H^i(C'_*), \quad \ext^i(M,N)' \to H^i(C'_*).
\]
The claim is that isomorphisms on
cohomology will be induced in each case. That will prove the
result, but we
shall not prove the claim.
\end{proof}

Last time we were talking about $\ext$ groups over commutative
rings. For $R$ a
commutative ring and $M,N$ $R$-modules, we defined an $R$-module
$\ext^i(M,N)$ for
each $i$, and proved various properties. We forgot to mention
one.

\begin{proposition}
If $R$ noetherian, and $M,N$ are finitely generated,
$\ext^i(M,N)$ is also finitely generated.
\end{proposition}
\begin{proof}
We can take a projective resolution $P_*$ of $M$ by finitely
generated free modules, $R$ being
noetherian. Consequently the complex $\hom(P_*, N)$ consists of
finitely
generated modules. Thus the cohomology is finitely generated,
and this cohomology
consists of the $\ext$ groups.
\end{proof}

\section{Homological theory of local rings}
\subsection{Depth} Let $(R, \mathfrak{m})$ be  a noetherian
local ring. Let $k = R/\mathfrak{m}$.

Let $M \neq 0$ be a finitely generated $R$-module.

\newcommand{\depth}{\operatorname{depth}}
\begin{definition}
The \textbf{depth} of $M$ is equal to the smallest integer $i$
such that
$\ext^i(k,M) \neq 0$.
\end{definition}

We'll give another characterization of this in just a minute.
Note that
contained in this definition is an assertion: that there is such
an $i$.

\begin{example}
Depth zero is equivalent to saying that $\ext^0(k,M) \neq 0$,
i.e. there is a
nontrivial morphism
\[ k \to M.  \]
As $k = R/\mathfrak{m}$, the existence of such a map is
equivalent to the existence of a nonzero $x$
such that $\ann(x) = \mathfrak{m}$, i.e. $\mathfrak{m} \in
\ass(M)$. So depth
zero is equivalent to having $\mathfrak{m} \in \ass(M)$.
\end{example}

Suppose now that $\depth(M) \neq 0$. In particular,
$\mathfrak{m} \notin
\ass(M)$. Since $\ass(M)$ is finite, prime avoidance that
$\mathfrak{m}
\not\subset \bigcup_{\mathfrak{p} \in \ass(M)} \mathfrak{p}$.
Thus
$\mathfrak{m}$ contains an element which is a nonzerodivisor on
$M$. So we find:

\begin{proposition}
$M$ has depth zero iff every element in $\mathfrak{m}$ is a
zerodivisor on $M$.
\end{proposition}

Now suppose $\depth M \neq 0$. There is $a \in \mathfrak{m}$
which is a
nonzerodivisor on $M$, i.e.  such that there is
an exact sequence
\[ 0 \to M \stackrel{a}{\to} M \to M/aM \to 0.  \]
There is a long exact sequence in $\ext$ groups:
\[\ext^{i-1}(k,M) \to \ext^i(k,M) \stackrel{a}{\to} \ext^i(k,M)
\to \ext^i(k,
M/aM) \to \ext^{i+1}(k,M)  .\]
However, the map $a: \ext^i(k,M) \to \ext^i(k,M)$ as
multiplication by $a$
kills $k$. (As we said last time, if $a$ kills a module $N$,
then it kills
$\ext^*(N,M)$ for all $M$.) We see from this that
\[ \ext^i(k,M) \hookrightarrow \ext^i(k,M/aM)  \]
is injective, and
\[ \ext^{i-1}(k, M/aM) \twoheadrightarrow \ext^i(k,M)  \]
is surjective.

\begin{corollary}
If $a \in \mathfrak{m}$ is a nonzerodivisor on $M$, then
\[ \depth(M/aM) = \depth M -1.  \]
\end{corollary}
\begin{proof}
When $\depth M = \infty$, this is easy (left to the reader) from
the exact
sequence. Suppose $\depth(M) = n$. We would like to see that
$\depth M/aM =
n-1$. That is, we want to see that $\ext^{n-1}(k,M/aM) \neq 0$,
but
$\ext^i(k,M/aM) =
0$ for $i < n-1$. This is direct from the injectivity and
surjectivity above.

In fact surjectivity of $\ext^{n-1}(k,M/aM) \to \ext^n(k,M)$
shows that
$\ext^{n-1}(k,M/aM) \neq 0$. Now let $i < n-1$. Then the exact
sequence
\[ \ext^i(k,M) \to \ext^i(k,M/aM) \to \ext^{i+1}(k,M)  \]
shows that $\ext^i(k, M/aM)$.
\end{proof}

When you mod out by a nonzerodivisor, the depth drops by one.

\begin{corollary}
The depth of $M$ is well-defined. In fact,
\[ \depth M \leq \dim \supp M.  \]
\end{corollary}
\begin{proof}
If $\depth M = 0$, then we're done.

In general, we induct on $\dim \supp M$, which we know is
finite. Otherwise,
there is $ a \in \mathfrak{m}$ which is a nonzerodivisor on $M$.
We know that
\[ \depth M/aM = \depth M -1  \]
and
\[ \dim \supp M/aM = \dim \supp M -1.  \]
By induction, we have that $\depth M/aM \leq \dim \supp M/aM$.
From this the
induction step is clear.
\end{proof}

Generally, the depth is not the dimension.
\begin{example}
Given any $M$, if you add $k$ to it, then you make the depth
zero: $M \oplus k$
has $\mathfrak{m}$ as an associated prime. But the dimension
generally does not
jump to zero.
\end{example}

In fact, we have described a recursive algorithm for computing
$\depth(M)$.
\begin{enumerate}
\item If $\mathfrak{m}  \in \ass(M)$, output zero.
\item If $\mathfrak{m} \notin \ass(M)$, choose an element $a
\in\mathfrak{m}$
which is a nonzerodivisor on $M$. Output $\depth(M/aM) +1$.
\end{enumerate}


If you were to apply this in practice, you would start by
looking for a
nonzerodivisor $a_1 \in \mathfrak{m}$ on $M$, then looking for
one on $M/a_1
M$, etc.
From this we make:

\begin{definition}
Let $(R, \mathfrak{m})$ be a local noetherian ring, $M$ a finite
$R$-module. A
sequence $a_1, \dots, a_n \in \mathfrak{m}$ is said to be
\textbf{$M$-regular} iff:
\begin{enumerate}
\item $a_1$ is a nonzerodivisor on $M$
\item $a_2$ is a nonzerodivisor on $M/a_1 M$
\item  $\dots$
\item $a_i$ is a nonzerodivisor on $M/(a_1, \dots, a_{i-1})M$
for all $i$.
\end{enumerate}
A regular sequence $a_1, \dots, a_n$ is \textbf{maximal } if it
can be extended
no further, i.e. there is no $a_{n+1}$ such that $a_1, \dots,
a_{n+1}$ is
$M$-regular.
\end{definition}

\begin{corollary}
$\depth(M)$ is the length of every maximal $M$-regular
sequence.In particular,
all $M$-regular sequences have the same length.
\end{corollary}

\begin{proof}
If $a_1, \dots, a_n$ is $M$-regular, then
\[ \depth M/(a_1, \dots, a_i)M = \depth M -i  \]
for each $i$, by an easy induction on $i$ and the definition.
Finally, if the sequence is maximal,
then $\mathfrak{m} \in \ass(M/(a_1, \dots, a_n)M)$ so $\depth
M/(a_1, \dots,
a_n) M = 0$.
\end{proof}

\begin{remark}
We could define the depth via the length of a maximal
$M$-regular sequence.
\end{remark}


\subsection{Cohen-Macaulayness}

\begin{definition}
Let $(R, \mathfrak{m})$ be a noetherian local ring. Then
we set $\depth R$ to be the its depth as an $R$-module.
\end{definition}




\begin{example}
If $R$ is regular, then $\depth R = \dim R$.
\end{example}
\begin{proof}
Induction on $\dim R$. If $\dim R=0$, then this is obvious by
the inequality
$\leq $ which is always true.

Suppose $\dim R = 0$. Then $\mathfrak{m} \neq 0$ and in
particular
$\mathfrak{m}/\mathfrak{m}^2 \neq 0$. Choose $x \in
\mathfrak{m}-
\mathfrak{m}^2$. Let $R'=R/(x)$. We know that $\dim R' = \dim
R-1$ as $x$ is a
nonzerodivisor (by regularity). On the other hand, the embedding
dimension of $R'$ also drops
by one, as we have divided out by something in $\mathfrak{m} -
\mathfrak{m}^2$.
In particular, $R'$ is regular local too. So the inductive
hypothesis states
that
\[\depth R-1 =  \depth R' = \dim R' = \dim R -1.   \]

Differently phrased, we could choose $x_1, \dots, x_n \in
\mathfrak{m}$ which forms a basis for
$\mathfrak{m}/\mathfrak{m}^2$; this is a
\emph{regular sequence} (that is, an $R$-regular sequence) by
this argument. It
is maximal as $x_1, \dots, x_n$ generate $\mathfrak{m}$ and
$R/(x_1, \dots,
x_n)$ clearly has depth zero.
\end{proof}

More generally:
\begin{definition}
A noetherian local ring $(R, \mathfrak{m})$ is called
\textbf{Cohen-Macaulay}
if $\dim R = \depth R$. A general noetherian ring $R$ is
\textbf{Cohen-Macaulay} if
$R_{\mathfrak{p}}$ is Cohen-Macaulay for all $\mathfrak{p} \in
\spec R$.
\end{definition}
For instance, any regular local ring is Cohen-Macaulay, as is
any local
artinian ring (because the dimension is zero for an artinian
ring).

We shall eventually prove:

\begin{proposition}
Let $R = \mathbb{C}[X_1, \dots, X_n]/\mathfrak{p}$ for
$\mathfrak{p}$ prime.
Choose an injective map $\mathbb{C}[y_1, \dots, y_n]
\hookrightarrow R$ making $R$ a
finite module. Then $R$ is Cohen-Macaulay iff $R$ is projective
as a module
over $\mathbb{C}[y_1, \dots, y_n]$.\footnote{In fact, this is
equivalent to
freeness, although we will not prove it. Any projective finite
module over a
polynomial ring over a field is free, though this is a hard
theorem.}
\end{proposition}

The picture is that the inclusion $\mathbb{C}[y_1, \dots, y_m ]
\hookrightarrow
\mathbb{C}[x_1, \dots, x_n]/\mathfrak{p}$ corresponds to a map
\[ X \to \mathbb{C}^m  \]
for $X = V(\mathfrak{p}) \subset \mathbb{C}^n$. This statement
of freeness is a
statement about how the fibers of this finite map stay similar
in some sense.

\begin{example}
Consider $\mathbb{C}[x,y]/(xy)$, the coordinate ring of the
union of two axes
intersecting at the origin. This is Cohen-Macaulay (but not
regular, as it
is not a domain). Indeed, we can project the associated variety
$X = V(xy)$
onto the affine line by adding the coordinates. This corresponds
to the map
\[ \mathbb{C}[z] \to \mathbb{C}[x,y]/(xy)  \]
sending $z \to x+y$. This makes $\mathbb{C}[x,y]/(xy)$ into a
free
$\mathbb{C}[z]$-module of rank two (with generators $1, x$), as
one can check.
So by the previous result (strictly speaking, its extension to
non-domains),
the ring in question is Cohen-Macaulay.
\end{example}

\begin{example}
$R=\mathbb{C}[x,y,z]/(xy, xz)$ is not Cohen-Macaulay (at the
origin). The associated variety looks
geometrically like the union of the plane $x=0$ and the line
$y=z=0$ in affine
3-space. Here there are two components of different dimensions
intersecting.
Let's choose a regular sequence (that is, regular after
localization at the
origin). The dimension at the origin is clearly two because of
the plane.
First, we need a nonzerodivisor in this ring, which vanishes at
the origin, say
$ x+y+z$. (\textbf{Exercise:} Check this.) When we quotient by
this, we get
\[ S=\mathbb{C}[x,y,z]/(xy,xz, x+y+z) = \mathbb{C}[y,z]/(
(y+z)y, (y+z)z). \]

The claim is that $S$ localized at the ideal corresponding to
$(0,0)$ has depth
zero. We have $y+z \neq 0$, which is killed by both $y,z$, and
hence by the
maximal ideal at zero. In particular the maximal ideal at zero
is an associated
prime, which implies the claim about the depth.
\end{example}

As it happens, a Cohen-Macaulay variety is always
equidimensional. The rough
reason is that each irreducible piece puts an upper bound on the
depth given by
the dimension of the piece. If any piece is too small, the total
depth will be
too small.

Anyway, we shall not say much more about Cohen-Macaulayness, but
instead focus
on understanding regular local rings. We want, for next time,
to understand the relationship
between depth and lengths of projective resolutions.
We will prove:

\begin{theorem}[Auslander-Buchsbaum formula] Let $(R,
\mathfrak{m})$ be a
noetherian local ring and $M$ a finite $R$-module. Suppose $M$
has a finite
projective resolution of length $d$, where $d$ is minimal.

Then
\[ d = \depth(R) - \depth(M).  \]
\end{theorem}
So in a sense, depth measures how far $M$ is from being a free
module. If the
depth is large, then you need a lot of projective modules to
resolve $M$.
\lecture{11/22}

Last time we were talking about depth. Let's use this to
reformulate a few
definitions made earlier.

\subsection{Reduced rings}
Recall that a noetherian ring is \textbf{reduced} iff:
\begin{enumerate}
\item For any minimal prime $\mathfrak{p} \subset R$,
$R_{\mathfrak{p}}$ is a
field.
\item Every associated prime of $R$ is minimal.
\end{enumerate}

Condition 1 can be reduced as follows. To say that
$\mathfrak{p}\subset R$ is
minimal is to say that it is zero-dimensional, and that is
regular iff it is a
field. So the first condition is that \emph{for every height
zero prime,
$R_{\mathfrak{p}}$ is regular.} For the second condition,
$\mathfrak{p} \in
\ass(R)$ iff $\mathfrak{p} \in \ass(R_{\mathfrak{p}})$, which is
equivalent to
$\depth R_{\mathfrak{p}} = 0$.

Namely, the two conditions are:
\begin{enumerate}
\item For every height zero prime $\mathfrak{p} $,
$R_{\mathfrak{p}}$ is
regular.
\item For every prime $\mathfrak{p}$ of height $>0$, $\depth
R_{\mathfrak{p}} >
0$.
\end{enumerate}

Condition two is always satisfied in a Cohen-Macaulay ring.

\subsection{Serre's criterion again}

Recall that
\begin{definition}
A noetherian ring is \textbf{normal} iff it is a finite direct
product of
integrally closed domains.
\end{definition}

In the homework, we showed:
\begin{proposition}
A reduced ring $R$ is normal iff
\begin{enumerate}
\item For every height one prime $\mathfrak{p}  \in \spec R$,
$R_{\mathfrak{p}}$ is a DVR (i.e. regular).
\item For every nonzerodivisor $x \in R$, every associated prime
of $R/x$ is
minimal.
\end{enumerate}
\end{proposition}
(We had proved this for \emph{domains} earlier.)
These conditions are equivalent to:
\begin{enumerate}
\item For every prime $\mathfrak{p}$ of height $\leq 1$,
$R_{\mathfrak{p}} $ is regular.
\item For every prime $\mathfrak{p}$ of height $\geq 1$,
$\depth R_{\mathfrak{p}} \geq 1$ (necessary for reducedness)
\item $\depth R_{\mathfrak{p}} \geq 2$ for $\mathfrak{p}$ not
minimal over any
principal ideal $(x)$ for $x$ a nonzerodivisor. Condition three
is the last
condition of the proposition as quotienting out by $x$ drops the
depth by one.
\end{enumerate}

The first and third conditions imply the second. In particular,
we find:

\begin{theorem}[Serre's criterion] A noetherian ring is normal
iff:
\begin{enumerate}
\item For every prime $\mathfrak{p}$ of height $\leq 1$,
$R_{\mathfrak{p}} $ is regular.
\item $\depth R_{\mathfrak{p}} \geq 2$ for $\mathfrak{p}$ not
minimal over any
principal ideal $(x)$ for $x$ a nonzerodivisor. \end{enumerate}
\end{theorem}
For a Cohen-Macaulay ring, the last condition is automatic, as
the depth is the
codimension.

\subsection{Projective dimension}

\newcommand{\pr}{\mathrm{pd}}
Let $R$ be a commutative ring, $M$ an $R$-module.

\begin{definition}
The \textbf{projective dimension} of $M$ is the largest integer
$n$ such that
there exists  a module $N$ with
\[ \ext^n(M,N) \neq 0.  \]
(If no such $n,N$ exist, then we say that the projective
dimension is $\infty$.)
We write $\pr(M)$ for the projective dimension.
\end{definition}

\begin{remark}
$\pr(M) = 0$ iff $M$ is projective. Indeed, we have seen that
the $\ext$ groups
$\ext^i(M,N), i >0$
vanish always.
\end{remark}

If you wanted to compute the projective dimension, you could go
as follows.
Take any $M$. Choose a surjection $P \twoheadrightarrow M$ with
$P$ projective;
call the kernel $K$ and draw a short exact sequence
\[ 0 \to K \to P \to M \to 0.  \]
For any $R$-module $N$, we have a long exact sequence
\[ \ext^{i-1}(P,N) \to \ext^{i-1}(K,N) \to \ext^i(M,N) \to
\ext^i(P, N). \]
If $i >0$, the right end vanishes; if $i >1$, the left end
vanishes. So if $i
>1$, this map $\ext^{i-1}(K,N) \to \ext^i(M,N)$ is an
\emph{isomorphism}.

Suppose that $\pr(K) = d \geq 0$. We find that
$\ext^{i-1}(K,N)=0$ for $i-1
> d$.
This implies that $\ext^i(M,N) = 0$ for such $i > d+1$. In
particular, $\pr(M)
\leq d+1$.
This argument is completely reversible if $d >0$.
Then we see from these isomorphisms that
\[ \boxed{\pr(M) = \pr(K)+1}, \quad \mathrm{unless} \ \pr(M)=0
\]
If $M$ is projective, the sequence $0 \to K \to P \to M \to 0$
splits, and
$\pr(K)=0$ too.

The upshot is that \textbf{we can compute projective dimension
by choosing a
projective resolution.}
\begin{proposition}
Let $M$ be an $R$-module. Then $\pr(M) \leq n$ iff there exists
a finite
projective resolution of $M$ having $n+1$ terms,
\[ 0 \to P_n \to \dots \to P_1 \to P_0 \to M \to 0.  \]
\end{proposition}
\begin{proof}
Induction on $n$. When $n = 0$, $M$ is projective, and we can
use the
resolution $0 \to M \to M \to 0$.

Suppose $\pr(M) \leq n$, where $n >0$. We can get a short exact
sequence
\[ 0 \to K \to P_0 \to M \to 0  \]
with $P_0$ projective, so $\pr(K) \leq n-1$. The inductive
hypothesis implies
that there is a projective resolution of $K$ of length $\leq
n-1$. We can
splice this in with the short exact sequence to get a projective
resolution of
$M$ of length $n$.

The argument is reversible. Choose any projective resolution
\[  0 \to P_n \to \dots \to P_1 \to P_0 \to M \to 0 \]
and split into short exact sequences, and argue inductively.
\end{proof}


Let $\pr(M) = n$. Choose any projective resolution $\dots \to
P_2 \to P_1 \to
P_0 \to M$. Choose $K_i = \ker(P_i \to P_{i-1})$ for each $i$.
Then there is a short exact sequence $0 \to K_0 \to P_0 \to M
\to 0$. Moreover,
there are exact sequences
\[ 0 \to K_i \to P_i \to K_{i-1} \to 0  \]
for each $i$. From these, we see that the projective dimensions
of the $K_i$
drop by one as $i$ increments. So $K_{n-1}$ is projective if
$\pr(M) = n$ as
$\pr(K_{n-1})=0$. In particular, we can get a projective
resolution
\[ 0 \to K_{n-1} \to P_{n-1} \to \dots \to P_0 \to M \to 0  \]
which is of length $n$.
In particular, if you ever start trying to write a projective
resolution of
$M$, you can stop after going out $n$ terms, because the kernels
will become
projective.


\subsection{Minimal projective resolutions}
Usually projective resolutions are non-unique. But sometimes
they kind of are.
Let $(R, \mathfrak{m})$ be a local noetherian ring, $M$ a
finitely generated $R$-module.

\begin{definition}
A projective resolution $P_* \to M$ of finitely generated
modules is \textbf{minimal} if for each $i$, the
induced map $P_i \otimes R/\mathfrak{m} \to P_{i-1} \otimes
R/\mathfrak{m}$ is
zero, and same for $P_0 \otimes R/\mathfrak{m} \to
M/\mathfrak{m}M$.
\end{definition}

This is equivalent to saying that for each $i$, the map $P_i
\to\ker(P_{i-1}
\to P_{i-2})$ is an isomorphism modulo $\mathfrak{m}$.

\begin{proposition}
Every $M$ (over a local noetherian ring) has a minimal
projective resolution.
\end{proposition}
\begin{proof}
Start with a module $M$. Then $M/\mathfrak{m}M$ is a
finite-dimensional vector
space over $R/\mathfrak{m}$, of dimension say $d_0$. We can
choose a basis for that vector space, which
we can lift to $M$. That determines a map of free modules
\[ R^{d_0} \to M,  \]
which is a surjection by Nakayama's lemma. It is by construction
an
isomorphism modulo $\mathfrak{m}$. Then define $K =
\ker(R^{d_0}\to M)$; this
is finitely generated by noetherianness, and we
can do the same thing for $K$, and repeat to get a map $R^{d_1}
\twoheadrightarrow K$ which is an isomorphism modulo
$\mathfrak{m}$. Then
\[ R^{d_1} \to R^{d_0} \to M \to 0  \]
is exact, and minimal; we can continue this by the same
procedure.
\end{proof}


\begin{proposition}
Minimal projective resolutions are unique up to isomorphism.
\end{proposition}
\begin{proof}
Suppose we have one minimal projective resolution:
\[ \dots \to P_2 \to P_1 \to P_0 \to M \to 0  \]
and another:
\[ \dots \to Q_2 \to Q _1 \to Q_0 \to M \to 0  .\]
There is always a map of projective resolutions $P_* \to Q_*$ by
general
homological algebra. There is, equivalently, a commutative
diagram
\[\xymatrix{ \dots \ar[d] \ar[r] & P_2\ar[d] \ar[r] & P_1
\ar[d]\ar[r]
& P_0 \ar[d] \ar[r] & M \ar[d]^{\mathrm{id}} \ar[r] & 0 \\
 \dots  \ar[r] &   Q_2  \ar[r] &  Q_1   \ar[r]
&  Q_0   \ar[r] &   M  \ar[r] &   0 } \]
If both resolutions are minimal, the claim is that this map is
an isomorphism.
That is, $\phi_i: P_i \to Q_i$ is an isomorphism, for each $i$.

To see this, note that $P_i, Q_i$ are finite free
$R$-modules.\footnote{We are
using the fact that a finite projective module over a local ring
is
\emph{free}.} So $\phi_i$ is an isomorphism iff $\phi_i$ is an
isomorphism
modulo the maximal ideal, i.e. if
\[ P_i/\mathfrak{m}P_i \to Q_i/\mathfrak{m}Q_i  \]
is an isomorphism. Indeed, if $\phi_i$ is an isomorphism, then
its tensor
product with $R/\mathfrak{m}$ obviously is an isomorphism.
Conversely suppose
that the reductions mod $\mathfrak{m}$ make an isomorphism. Then
the ranks of
$P_i, Q_i$ are the same, and $\phi_i$ is an $n$-by-$n$ matrix
whose determinant
is not in the maximal ideal, so is invertible. This means that
$\phi_i$ is invertible by the
usual formula for the inverse matrix.

So we are to check that $P_i / \mathfrak{m}P_i \to Q_i /
\mathfrak{m}Q_i$ is an
isomorphism for each $i$. This is equivalent to the assertion
that
\[ (Q_i/\mathfrak{m}Q_i)^{\vee} \to
(P_i/\mathfrak{m}P_i)^{\vee}\]
is an isomorphism. But this is the map
\[ \hom_R(Q_i, R/\mathfrak{m}) \to \hom_R(P_i, R/\mathfrak{m}).
\]
If we look at the chain complexes $\hom(P_*, R/\mathfrak{m}),
\hom(Q_*,
R/\mathfrak{m})$, the cohomologies
compute the $\ext$ groups of $(M, R/\mathfrak{m})$. But all the
maps in this
chain complex are zero because the resolution is minimal, and we
have that the
image of $P_i$ is contained in $\mathfrak{m}P_{i-1}$ (ditto for
$Q_i$). So the
cohomologies are just the individual terms, and the maps
$ \hom_R(Q_i, R/\mathfrak{m}) \to \hom_R(P_i, R/\mathfrak{m})$
correspond to
the identities on $\ext^i(M, R/\mathfrak{m})$. So these are
isomorphisms.\footnote{We are sweeping under the rug the
statement that $\ext$
can be computed via \emph{any} projective resolution. More
precisely, if you
take any two projective resolutions, and take the induced maps
between the
projective resolutions, hom them into $R/\mathfrak{m}$, then the
maps on
cohomology are isomorphisms.}
\end{proof}


\begin{corollary}
If $\dots \to P_2 \to P_1 \to P_0 \to M$ is a minimal projective
resolution of
$M$, then the ranks $\mathrm{rank}(P_i)$ are well-defined (i.e.
don't depend
on the choice of the minimal resolution).
\end{corollary}
\begin{proof}
Immediate from the proposition. In fact, the ranks are the
dimensions (as
$R/\mathfrak{m}$-vector spaces) of $\ext^i(M, R/\mathfrak{m})$.
\end{proof}

Let us advertise the goal for next time. We would like to prove
Serre's
criterion for regularity.

\begin{theorem}
Let $(R, \mathfrak{m})$ be a local noetherian ring. Then $R$ is
regular iff
$R/\mathfrak{m}$ has finite projective dimension. In this case,
$\pr(R/\mathfrak{m}) = \dim R$.
\end{theorem}
\lecture{11/24}

\subsection{The Auslander-Buchsbaum formula}

Today, we shall start by proving:

\begin{theorem}[Auslander-Buschsbaum formula]
Let $R$ be a local noetherian ring, $M$ a f.g. $R$-module of
finite
projective dimension. If $\pr(R) <
\infty$, then $\pr(M) = \depth(R) - \depth(M)$.
\end{theorem}

\begin{proof}
Induction on $\pr(M)$. When $\pr(M)=0$, then $M$ is projective,
so isomorphic
to $R^n$ for some $n$. Thus $\depth(M) = \depth(R)$.

Assume $\pr(M) > 0$.
Choose a surjection $P \twoheadrightarrow M$ and write an exact
sequence
\[ 0 \to K \to P \to M \to 0,  \]
where $\pr(K) = \pr(M)-1$. We also know by induction that
\[ \pr(K) = \depth R - \depth(K).  \]
What we want to prove is that
\[ \depth R - \depth M = \pr(M) = \pr(K)+1.  \]
This is equivalent to wanting know that $\depth(K) = \depth (M)
+1$.
In general, this may not be true, though, but we will prove it
under
minimality hypotheses.

Without loss of generality, we can choose that $P$ is
\emph{minimal}, i.e.
becomes an isomorphism modulo the maximal ideal $\mathfrak{m}$.
This means
that the rank of $P$ is $\dim M/\mathfrak{m}M$.
So $K = 0$ iff $P \to M$ is an isomorphism; we've assumed that
$M$ is not
free, so $K \neq 0$.

Recall that the depth of $M$ is the smallest value $i$ such
that$\ext^i(R/\mathfrak{m}, M) \neq 0$. So we should look at the long exact
sequence from the above short exact sequence:
\[ \ext^i(R/\mathfrak{m}, P) \to  \ext^i(R/\mathfrak{m},M)  \to
\ext^{i+1}(R/\mathfrak{m}, K) \to \ext^{i+1}(R/\mathfrak{m},
P).\]
Now $P$ is just a direct sum of copies of $R$, so
$\ext^i(R/\mathfrak{m}, P)$
and $\ext^{i+1}(R/\mathfrak{m}, P)$ are zero if $i+1< \depth R$.
In
particular, if $i+1< \depth R$, then the map $
\ext^i(R/\mathfrak{m},M) \to
\ext^{i+1}(R/\mathfrak{m}, K) $ is an isomorphism.
So we find that $\depth M + 1 = \depth K$ in this case.

We have seen that \emph{if $\depth K < \depth R$, then } by
taking $i$ over
all integers $< \depth K$, we find that
\[ \ext^{i}(R/\mathfrak{m}, M) = \begin{cases}
0 & \mathrm{if \ } i+1 < \depth K \\
\ext^{i+1}(R/\mathfrak{m},K) & \mathrm{if \ } i+1 = \depth K
\end{cases}. \]
In particular, we are \textbf{done} unless $\depth K \geq \depth
R$.
By the inductive hypothesis, this is equivalent to saying that
$K$ is
projective.

So let us consider the case where $K$ is projective, i.e.
$\pr(M)=1$.
We want to show that $\depth M = d-1$ if $d = \depth R$.
We need a
slightly different argument in this case. Let $d = \depth(R) =
\depth (P) =
\depth(K)$ since $P,K$ are free. We have a short exact sequence
\[ 0 \to K \to P \to M \to 0  \]
and a long exact sequence of $\ext$ groups:
\[ 0 \to \ext^{d-1}(R/\mathfrak{m}, M) \to
\ext^d(R/\mathfrak{m}, K) \to \ext^d(R/\mathfrak{m}, P) .\]
We know that $\ext^d(R/\mathfrak{m}, K)$ is nonzero as $K$ is
free and $R$ has
depth $d$. However, $\ext^i(R/\mathfrak{m}, K) =
\ext^i(R/\mathfrak{m}, P)=0$
for $i<d$. This implies that $\ext^{i-1}(R/\mathfrak{m}, M)=0$
for $i<d$.

We will show:
\begin{quote}
The map $\ext^d(R/\mathfrak{m}, K) \to \ext^{d}(R/\mathfrak{m},
P)$ is zero.
\end{quote}
This will imply that the depth of $M$ is \emph{precisely} $d-1$.
This is because the matrix $K \to P$ is given by multiplication
by a matrix
with coefficients in $\mathfrak{m}$ as $K/\mathfrak{m}K \to
P/\mathfrak{m}P$
is zero. In particular, the map on the $\ext$ groups is zero,
because it is
annihilated by $\mathfrak{m}$.
\end{proof}

\begin{example}
Let $R = \mathbb{C}[x_1, \dots, x_n]/\mathfrak{p}$ for
$\mathfrak{p}$ prime.
Choose an injection $R' \to R$ where $R' = \mathbb{C}[y_1,
\dots, y_m]$ and
$R$ is a f.g. $R'$-module. This exists by the Noether
normalization lemma.

We wanted to show:

\begin{theorem}
$R$ is Cohen-Macaulay\footnote{That is, its localizations at any
prime---or,
though we haven't proved yet, at any maximal ideal---are.} iff
$R$ is a
projective $R'$-module.
\end{theorem}

We shall use the fact that projectiveness can be tested locally
at every
maximal ideal.

\begin{proof}
Choose a maximal ideal $\mathfrak{m} \subset R'$. We will show
that
$R_{\mathfrak{m}}$ is a free $R'_{\mathfrak{m}}$-module via the
injection of
rings $R'_{\mathfrak{m}} \hookrightarrow R_{\mathfrak{m}}$
(where
$R_{\mathfrak{m}}$ is defined as $R$ localized at the
multiplicative subset
of elements of $R' - \mathfrak{m}$) at each $\mathfrak{m}$ iff
Cohen-Macaulayness holds.

Now $R'_{\mathfrak{m}}$ is a regular local ring, so its depth is
$m$. By the
Auslander-Buchsbaum formula, $R_{\mathfrak{m}}$ is projective as
an
$R'_{\mathfrak{m}}$-module iff
\[ \depth_{R'_{\mathfrak{m}}} R_{\mathfrak{m}} = m.  \]
Now $R$ is a projective module iff the above condition holds for
all maximal
ideals $\mathfrak{m} \subset R'$. The claim is that this is
equivalent to
saying that $\depth R_{\mathfrak{n}} = m = \dim
R_{\mathfrak{n}}$
for every maximal ideal $\mathfrak{n} \subset R$ (depth over
$R$!).

These two statements are almost the same, but one is about the
depth of $R$ as
an $R$-module, and another as an $R'$-module.

\begin{quote}
Issue: There may be several maximal ideals of $R$ lying over the
maximal ideal
$\mathfrak{m} \subset R'$.
\end{quote}

The problem is that $R_{\mathfrak{m}}$ is not generally local,
and not
generally equal to $R_{\mathfrak{n}}$ if $\mathfrak{n}$ lies
over
$\mathfrak{m}$. Fortunately, depth makes sense even over
semi-local rings
(rings with finitely many maximal ideals).

Let us just assume that this does not occur, though. Let us
assume that
$R_{\mathfrak{m}}$ is a local ring for every maximal ideal
$\mathfrak{m}
\subset R$. Then we are reduced to showing that if $S =
R_{\mathfrak{m}}$,
then the depth of $S$ as an $R'_{\mathfrak{m}}$-module is the
same as the
depth as an $R_{\mathfrak{m}}$-module. That is, the depth
doesn't depend too
much on the ring, since $R'_{\mathfrak{m}}, R_{\mathfrak{m}}$
are ``pretty
close.'' If you believe this, then you believe the theorem, by
the first
paragraph.


Let's prove this claim in a more general form:

\begin{proposition}
Let $\phi: S' \to S$ be a local\footnote{I.e. $\phi$ sends
non-units into
non-units.} map of local noetherian rings such that $S$ is a
f.g.
$S'$-module. Then, for any finitely generated $S$-module $M$,
\[ \depth_S M = \depth_{S'} M.  \]
\end{proposition}
With this, the theorem will be proved.

\begin{remark}
This result generalizes to the semi-local case, which is how
one side-steps
the issue above.
\end{remark}

\begin{proof}
By induction on $\depth_{S'} M$. There are two cases.

Let $\mathfrak{m}', \mathfrak{m}$ be the maximal ideals of $S',
S$.
If $\depth_{S'}(M) >0$, then there is an element $a$ in
$\mathfrak{m}'$ such
that
\[ M \stackrel{\phi(a)}{\to} M \]
is injective. Now $\phi(a) \in \mathfrak{m}$. So $\phi(a)$ is a
nonzerodivisor, and we have an exact sequence
\[ 0 \to M \stackrel{\phi(a)}{\to} M \to M/\phi(a) M \to 0.  \]
Thus we find
\[ \depth_{S} M > 0 . \]
Moreover, we find that $\depth_S M = \depth_S (M/\phi(a) M) +1$
and
$\depth_{S'} M = \depth_{S'}(M/\phi(a) M))+1$. The inductive
hypothesis now
tells us that
\[ \depth_S M = \depth_{S'}M.  \]

The hard case is where $\depth_{S'} M = 0$. We need to show that
this is
equivalent to $\depth_{S} M = 0$. So we know at first that
$\mathfrak{m}' \in
\ass(M)$. That is, there is an element $x \in M$ such that
$\ann_{S'}(x) =
\mathfrak{m}'$.
Now $\ann_S(x) \subsetneq S$ and contains $\mathfrak{m}' S$.

$Sx \subset M$ is a submodule, surjected onto by $S$ by the map
$a \to ax$.
This map actually, as we have seen, factors through
$S/\mathfrak{m}' S$. Here
$S$ is a finite $S'$-module, so $S/\mathfrak{m}'S$ is a finite
$S'/\mathfrak{m}'$-module. In particular, it is a
finite-dimensional vector space
over a field. It is thus a local artinian ring. But $Sx$ is a
module over this
local artinian ring. It must have an associated prime, which is
a maximal
ideal in $S/\mathfrak{m}'S$. The only maximal ideal can be
$\mathfrak{m}/\mathfrak{m}'S$. It follows that $\mathfrak{m}
\in\ass(Sx)
\subset \ass(M)$.

In particular, $\depth_S M = 0$ too, and we are done.
\end{proof}

\end{proof}
\end{example}
